from genetski import neural_netowrk,Dataset


nn = neural_netowrk("2x8x3")
data = Dataset(r"Lab07\dataset.txt")
params = [0.504072495695875, -0.16451265951933403, -0.6758253661274413, 0.5497367220023093, -0.26081085561672224, -1.0413672050795872, 0.1429937800501333, 0.38583628646358886, 0.3964663570929762, 0.06699125648346832, 0.855978679927335, -0.1850809722938126, 0.48272055537321057, -0.4710325781288558, 0.08961674968019179, -1.7069137844057058, 2.4279768914346023, -2.7918091968481553, 0.7465168422827427, 3.758091725510827, 0.3124988081513993, 0.3479929185250861, 0.25048988158568875, -0.5590850064169588, 0.4908433173266138, 0.2079540001078034, -0.711701465830376, -0.29385463495553, 0.5808058285611322, 0.08877344128849357, 0.7036974227385782, 0.19098143161786352, 35.146279375237484, -7.962634175268526, -1.8788739237839556, 4.17694464814837, -14.512550904839436, 0.00981063866669313, -0.1127501922265817, 63.328674555141625, -6.808829294618118, -0.000279763517892749, 1.1367929332466313, -25.655161657641088, -1.7580341823146863, 3.8436470386559973, -4.813775121993043, 25.13167184336516, -19.271182150704135, 16.388322684247928, -3.2401174535233013, 18.91407966206332, 51.32957014618891, -0.008800546200967284, -2.7070473855363275, 0.44655389453953365, 60.924966878591604, -10.784829639357081, -1.9762610154244702, 4.1023323570401035e-07]

bad_params = [0.4310226655859253, -0.8469539411336353, -0.43021594915639616, -0.6229235382102789, 0.6248486087294443, -0.8398962663733556, 0.7953255901669571, 0.9520488821248718, -0.6778253940382191, 0.15880511640543205, 0.46950325313839736, 0.3670017604002309, 0.7525943782947291, 0.9472717683530372, 0.8616356581614526, 0.10999840197295807, 0.18705832457386906, 0.14224239384711335, -0.5416126470321281, -0.880498531250584, 0.7366376691370309, -0.9240842903230764, -0.7547679441984398, -0.2956250093339452, 0.5441047969926893, 0.3295062390432102, -0.44777093098176923, -0.43939346581214855, -0.30317318551355776, -0.9245267633851459, -0.6541468122086913, -0.3742971725317159, -0.09101264411524013, -0.04684380599579274, 0.3072021819509947, -0.4312588425989492, -0.7406857432755738, -0.8019646674448027, 0.7967206818154762, -0.7607209773538504, 0.16766144177181164, 0.5023431816035597, 0.22491637010308585, -0.8057723730289266, 0.5602766596067073, -0.5877665470273594, -0.6342054799853296, -0.32531447183677464, 0.5443993768549527, -0.8272034234377463, 0.7200065311562307, 0.850146079947947, 0.5617721582931383, -0.3940321172254255, 0.2795537520535112, 0.01961096604921142, -0.8455328413805792, -0.5599059009458172, 0.4807375604852526, 0.797909444531633]

tocno = 0

for line in data.data:
    output = nn.calcOuput(line[0],line[1],params)

    for index in range(len(output)):
        if output[index] <= 0.5:
            output[index] = 0.0
        else:
            output[index] = 1.0

    same = output[0] == line[2] and output[1] == line[3] and output[2] == line[4]
    if same:
        tocno += 1

    print("True value: {}, predicted: {}, correct: {}".format([line[2],line[3],line[4]],output,same))

print("Accuracy: {}".format(tocno/len(data.data)))